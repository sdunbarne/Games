library("markovchain")

N <- 27
stateNames <- as.character( 1:N )

P <- matrix(0, 27, 27)

P[1,2] <- 1/2; P[1,3] <- 1/2;
P[2,1] <- 1/3; P[2,3] <- 1/3; P[2,4] <- 1/3;
P[3,1] <- 1/3; P[3,2] <- 1/3; P[3,5] <- 1/3;
P[4,2] <- 1/3; P[4,6] <- 1/3; P[4,7] <- 1/3;
P[5,3] <- 1/3; P[5,8] <- 1/3; P[5,9] <- 1/3;
P[6,4] <- 1/3; P[6,7] <- 1/3; P[6,10] <- 1/3;
P[7,4] <- 1/3; P[7,6] <- 1/3; P[7,8] <- 1/3;
P[8,5] <- 1/3; P[8,7] <- 1/3; P[8,9] <- 1/3;
P[9,5] <- 1/3; P[9,8] <- 1/3; P[9,11] <- 1/3;
P[10,6] <- 1/3; P[10,12] <- 1/3; P[10,13] <- 1/3;
P[11,9] <- 1/3; P[11,14] <- 1/3; P[11,15] <- 1/3;
P[12,10] <- 1/3; P[12,13] <- 1/3; P[12,16] <- 1/3;
P[13,10] <- 1/3; P[13,12] <- 1/3; P[13,17] <- 1/3;
P[14,11] <- 1/3; P[14,15] <- 1/3; P[14,18] <- 1/3;
P[15,11] <- 1/3; P[15,14] <- 1/3; P[15,19] <- 1/3;
P[16,12] <- 1/3; P[16,20] <- 1/3; P[16,21] <- 1/3;
P[17,13] <- 1/3; P[17,22] <- 1/3; P[17,23] <- 1/3;
P[18,14] <- 1/3; P[18,24] <- 1/3; P[18,25] <- 1/3;
P[19,15] <- 1/3; P[19,26] <- 1/3; P[19,27] <- 1/3;
P[20,20] <- 1;
P[21, 16] <- 1/3; P[21, 20] <- 1/3; P[21, 22] <- 1/3;
P[22, 17] <- 1/3; P[22, 21] <- 1/3; P[22, 23] <- 1/3;
P[23, 17] <- 1/3; P[23, 22] <- 1/3; P[23, 24] <- 1/3;
P[24, 18] <- 1/3; P[24, 23] <- 1/3; P[24, 25] <- 1/3;
P[25, 18] <- 1/3; P[25, 24] <- 1/3; P[25, 26] <- 1/3;
P[26, 19] <- 1/3; P[26, 25] <- 1/3; P[26, 27] <- 1/3;
P[27, 27] <- 1;

startState <- "1"

towerHanoi <- new("markovchain", transitionMatrix=P,
                 states=stateNames, name="towerHanoi")

meanAbsorptionTime(towerHanoi)[1]
